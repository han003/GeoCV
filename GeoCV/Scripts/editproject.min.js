function endreProfilNavn(){var n=$("body").data("id"),t=$("#endre-txt").val();console.log(n);$.ajax({url:"/EditProject/EndreProfilNavn",data:{ProfilId:n,Navn:t},type:"POST",beforeSend:function(){$("#endreModal button").addClass("hidden");$("#endreModal i").removeClass("hidden")},success:function(){console.log("Success");$("#endreModal").modal("hide");var r=$("#"+n+"-collapse").prev().find("a"),i=r.html();$("#"+n+"-collapse").prev().attr("id",t+"-heading");r.html(i.replace(i.substring(0,i.indexOf("<")),t))}})}function getKatalogElementer(){$.ajax({url:"/EditProject/GetKatalogElementer",type:"GET",dataType:"json",success:function(n){console.log(n);var t=[],i=[];$.each(n,function(n,r){t.push(r.Element);i.push(r.ListeKatalogId);$("#alle-elementer-tabell tbody").append('<tr id="'+r.ListeKatalogId+'"><td class="col-lg-2">'+r.Element+'<\/td><td class="col-lg-3">'+r.Katalog+'<\/td><td class="col-lg-1"><i class="fa fa-plus-square fa-lg add-item-btn"><\/i><\/td><\/tr>')})}})}function updateProjectInfo(n){var t=n.attr("id").substring(0,n.attr("id").indexOf("-")),i=n.val(),r=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);$.ajax({url:"/EditProject/UpdateProjectInfo",data:{Id:r,Update:t,Value:i},type:"POST",beforeSend:function(){n.parent().next().removeClass("hidden")},success:function(){console.log("Lagt til");n.parent().next().addClass("hidden")}})}function nyProfil(){var t=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1),n=$("#ny-profil-navn-txt").val();console.log(t+" - "+n);$.ajax({url:"/EditProject/LeggTilProfil",data:{Id:t,Navn:n},type:"POST",beforeSend:function(){$("#ny-profil-lagre-btn").html('Lagrer <i class="fa fa-spinner fa-spin"><\/i>')},success:function(t){console.log("lagt til profil id: "+t);$("#ny-profil-navn-txt").val("");$("#ny-profil-lagre-btn").html("Legg til");leggTilNyttPanel(t,n)}})}function oppdaterDatabase(n){var i=n.closest("table").attr("id"),r,t;console.log(i);r=i.substring(0,i.indexOf("-"));t="";$.each($(n).children("tr"),function(){var n=$(this).attr("id");t+=n+";"});t=t.substring(0,t.length-1);console.log("Profil Id: "+r);console.log("Value: "+t);$.post("/EditProject/OppdaterProfil",{ProfilId:r,Verdi:t})}function leggTilNyttPanel(n,t){var i="";i='<div class="panel panel-default"><div class="panel-heading" role="tab" id="'+t+'-heading"><h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" aria-expanded="false" aria-controls="'+t+'-collapse">'+t+'<i class="fa fa-trash-o pull-right"><\/i><i class="fa fa-pencil-square-o pull-right"><\/i><\/a><\/h4><\/div><div id="'+n+'-collapse" class="panel-collapse collapse" role="tabpanel" aria-labelledby="'+t+'-heading"><div class="panel-body"><table id="'+n+'-profil-table" class="table profil-tabell"><thead><tr><th class="col-lg-3">Element<\/th><th class="col-lg-2">Katalog<\/th><th class="col-lg-1"><\/th><\/tr><\/thead><tbody><\/tbody><\/table><\/div><\/div><\/div>';$("#accordion").prepend(i)}function hentElementer(n,t,i){$.ajax({url:"/EditProject/HentElementer",data:{Elementer:i},type:"GET",success:function(t){$.each(t,function(t,i){$("#"+n+"-profil-table tbody").append('<tr id="'+i.ListeKatalogId+'"><td class="col-lg-3">'+i.Element+'<\/td><td class="col-lg-2">'+i.Katalog+'<\/td><td class="col-lg-1"><i class="fa fa-minus-square fa-lg remove-item-btn"><\/i><\/td><\/tr>')})}})}function leggTilTekniskeProfiler(){var n=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);$.ajax({url:"/EditProject/GetAlleTeknologier",type:"GET",data:{Id:n},dataType:"json",success:function(n){console.log(n);$.each(n,function(n,t){leggTilNyttPanel(t.TekniskProfilId,t.Navn);hentElementer(t.TekniskProfilId,t.Navn,t.Elementer)})}})}var dbOppdateringsKolonne;$(document).ready(function(){$("#alle-elementer-tabell").stupidtable();$("#alle-elementer-tabell").bind("aftertablesort",function(n,t){var i=t.column,r=t.direction;$.each($("#alle-elementer-tabell th i"),function(n){console.log(n);n==i?($(this).removeClass("hidden"),$(this).removeClass("fa-sort-desc"),$(this).removeClass("fa-sort-asc"),r=="asc"?$(this).addClass("fa-sort-asc"):$(this).addClass("fa-sort-desc")):$(this).addClass("hidden")})});getKatalogElementer();leggTilTekniskeProfiler()});$(".table-filter").keyup(function(){var n=$(this).val().toLowerCase();console.log("Filter: "+n);$("#alle-elementer-tabell tbody tr").each(function(){var t=$(this).children("td").html().toLowerCase(),i=$(this).children("td").next().html().toLowerCase();t.indexOf(n)>=0||i.indexOf(n)>=0?$(this).removeClass("hidden"):$(this).addClass("hidden")})});$(document).on("click",".fa-trash-o",function(n){var t,i;n.preventDefault();n.stopPropagation();t=$(this).closest(".panel-heading").next().attr("id");t=t.substring(0,t.indexOf("-"));$("body").data("id",t);i=$(this).closest(".panel-heading").attr("id");i=i.substring(0,i.indexOf("-"));console.log(t);$("#profil-slett-etikett").html(i);$("#slettModal").modal()});$("#slett-profil-btn").click(function(){var n=$("body").data("id");console.log(n);$.ajax({url:"/EditProject/SlettProfil",data:{Id:n},type:"POST",beforeSend:function(){$("#slettModal button").addClass("hidden");$("#slettModal i").removeClass("hidden")},success:function(){console.log("Success");$("#slettModal").modal("hide");$("#"+n+"-collapse").closest(".panel").remove()}})});$("#slettModal").on("hidden.bs.modal",function(){$("#slettModal button").removeClass("hidden");$("#slettModal i").addClass("hidden")});$("#endreModal").on("hidden.bs.modal",function(){$("#endreModal button").removeClass("hidden");$("#endreModal i").addClass("hidden")});$(document).on("click",".fa-pencil-square-o",function(n){var t,i;n.preventDefault();n.stopPropagation();t=$(this).closest(".panel-heading").next().attr("id");t=t.substring(0,t.indexOf("-"));$("body").data("id",t);i=$(this).closest(".panel-heading").attr("id");i=i.substring(0,i.indexOf("-"));console.log(t);$("#endre-txt").val(i);$("#endreModal").modal()});$("#endre-profil-btn").click(function(){endreProfilNavn()});$("#endreModal").on("shown.bs.modal",function(){$("#endre-txt").focus()});$(document).keypress(function(n){var t=n.keyCode?n.keyCode:n.which;t=="13"&&$("#endreModal").is(":visible")&&endreProfilNavn()});$(".update-txt").keyup(function(){updateProjectInfo($(this))});$("#ny-profil-lagre-btn").click(function(){nyProfil()});$("#ny-profil-navn-txt").keypress(function(n){n.which==13&&nyProfil()});$(document).on("click",".panel-heading",function(){var n=$(this).next();$.each($(".panel-collapse"),function(){$(this).attr("id")==n.attr("id")?$(this).collapse("toggle"):$(this).hasClass("in")&&$(this).collapse("toggle")})});$(document).on("click",".remove-item-btn",function(){var n=$(this).closest("tbody"),t=$(this).closest("tr").remove();oppdaterDatabase(n)});$(document).on("click",".add-item-btn",function(){var i=$(this).closest("td").prev().html(),n,r,t;console.log("Katalog: "+i);n=$(this).closest("td").prev().prev().html();console.log("Legg til: "+n);r=$(this).closest("tr").attr("id");$.each($(".panel-collapse"),function(){$(this).hasClass("in")&&(t=$(this).find("table tbody"),$.each($("#alle-elementer-tabell tbody tr"),function(){var u=$(this).children("td:first").html();n==u&&t.append('<tr id="'+r+'"><td class="col-lg-2">'+n+'<\/td><td class="col-lg-3">'+i+'<\/td><td class="col-lg-1"><i class="fa fa-minus-square fa-lg remove-item-btn"><\/i><\/td><\/tr>')}))});oppdaterDatabase(t)});
//# sourceMappingURL=editproject.min.js.map
